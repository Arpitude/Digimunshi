<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Axio — Register</title>
  <link rel="stylesheet" href="assets/css/style.css" />
  <link rel="stylesheet" href="assets/css/animations.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="assets/js/toast.js"></script>
</head>

<body class="login-body">

  <div class="login-container glass fade-in">
    <h2 class="title">Create Account ✨</h2>
    <p class="subtitle">Join Axio to track your wealth</p>

    <form>
      <input type="text" placeholder="Full Name" class="input" />
      <input type="email" placeholder="Email" class="input" />
      <input type="password" placeholder="Password" class="input" />
      <input type="password" placeholder="Confirm Password" class="input" />
      
      <button type="button" onclick="register()" class="btn-primary">Sign Up</button>
    </form>

    <p class="footer-text">Already have an account? <a href="index.html">Login</a></p>
  </div>

  <script>
    gsap.from(".login-container", { y: 50, opacity: 0, duration: 0.8, ease: "power2.out" });
  </script>

  <script>
    const API_BASE = "https://axio-backendapp.onrender.com/api";

    async function register() {
        const name = document.querySelectorAll(".input")[0].value.trim();
        const email = document.querySelectorAll(".input")[1].value.trim();
        const password = document.querySelectorAll(".input")[2].value.trim();
        const confirmPassword = document.querySelectorAll(".input")[3].value.trim();
        const registerBtn = document.querySelector('.btn-primary');

        if (!name || !email || !password || !confirmPassword) {
            showError("Missing Fields", "Please fill in all fields");
            return;
        }

        if (password !== confirmPassword) {
            showError("Password Mismatch", "Passwords do not match");
            return;
        }

        // Show loading state
        registerBtn.disabled = true;
        const originalText = registerBtn.innerHTML;
        registerBtn.innerHTML = '<span class="btn-loader"></span>Creating account...';
        showInfo("Processing", "Setting up your account...");

        try {
            const res = await fetch(`${API_BASE}/signup.php`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ name, email, password }),
                credentials: 'include'
            });

            const data = await res.json();

            if (data.status === "success") {
                showSuccess("Registration Successful", "Please login with your credentials");
                // Redirect to login after delay
                setTimeout(() => {
                    window.location.href = "index.html";
                }, 2000);
            } else {
                showError("Registration Failed", data.message || "Please try again");
                registerBtn.disabled = false;
                registerBtn.innerHTML = originalText;
            }

        } catch (err) {
            console.error(err);
            showError("Error", "Network error: " + err.message);
            registerBtn.disabled = false;
            registerBtn.innerHTML = originalText;
        }
    }
  </script>
</body>
</html>
